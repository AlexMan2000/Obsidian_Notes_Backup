# 1 全微分和链式法则
[Chain Rule and Total Differentials.pdf](https://www.yuque.com/attachments/yuque/0/2022/pdf/12393765/1658757572717-d4657872-c4a3-4dfb-aad9-3ae864a5d7dc.pdf)

## 1.1 偏导数
### Definition
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044195567.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044193431.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044198496.png)


## 1.2 全微分**⭐**
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044193150.png)
> $dx,dy.dz$被称为`Differentials`, 微分, 那么如何理解他们呢?
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044194629.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044198843.png)



## 1.3 链式法则初步**⭐⭐**
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044201743.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044206003.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044201134.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044203173.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044202277.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044208089.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044206287.png)


## 1.4 偏微分方程
### 1.4.1 拉普拉斯方程
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044202554.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044207971.png)



### 1.4.2 Wave Equation
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044218541.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044218073.png)





## 1.5 练习
### 全微分
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044217393.png)



### 链式法则
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044219045.png)



### Approximation
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044219340.png)



### 热力学应用
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044214642.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044215164.png)


### 链式法则
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044219059.png)


# 2 更多变量的链式法则
[Chain Rule.pdf](https://www.yuque.com/attachments/yuque/0/2022/pdf/12393765/1659357816260-e3e1ab19-d14b-48c1-9337-db0342cc5aa5.pdf)
## 2.1 定义
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044222612.png)
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044225852.png)

:::

### 算例1
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044229077.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044221078.png)



### 算例2
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044226341.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044224822.png)


### 算例3
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044221288.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044238921.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044232765.png)



## 2.2 链式法则和全微分⭐⭐
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044237921.png)

1. **By Total Differentials**

![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044234199.png)

2. **By Chain Rule**

![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044236762.png)

3. **Example**

![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044234090.png)
:::


### 算例1
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044239152.png)
:::
**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044232242.png)

### 算例2
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044231837.png)
:::
**(a)**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044249396.png)
**(b)**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044243898.png)
**(c)**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044249599.png)



## 2.3 证明
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044248990.png)
:::


## 2.4 Ambiguous Notation
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044247244.png)
:::

## 2.5 隐函数求导法则
### 2.5.0 前言
> **对于单变量函数，我们有:**
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044246933.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044242612.png)


### 2.5.1 定义
> **链式法则可以用于完善多变量隐函数求导法则。**
> 假设一个方程$F(x,y)=0$,其中$y=f(x)$, 则我们有$F(x,f(x))=0$, 我们对等式两侧同时使用链式法则对$x$求导可得：$\frac{\partial F}{\partial x}\frac{dx}{dx}+\frac{\partial F}{\partial y}\frac{dy}{dx}=0$，所以:
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044248770.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044248927.png)



### 2.5.3 多元函数的推广
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044254231.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044255847.png)


## 2.6 Problems
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044258549.png)
:::
### P1 链式法则
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044258083.png)
:::
**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044259419.png)


### P2 全微分
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044257592.png)
:::
**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044253392.png)


### P3 极坐标
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044255582.png)
:::
**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044264879.png)

### P4 Chain Rule vs Total differentials
:::info
**Suppose **$z=x^2+y^2,x=u^2-v^2,y=uv$
**a). Write the total differential **$dz$**in terms of **$dx, dy$
**b). Compute **$\frac{\partial z}{\partial u}$**in two ways, using chain rule and differentials**
:::
**(a)**$dz=z_xdx+z_ydy$
**(b)**
1. **首先我们使用**`**Chain Rule**`**:**

$\frac{\partial z}{\partial u}=\frac{\partial z}{\partial x}\frac{\partial x}{\partial u}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial u}=4ux+2vy$

2. **接着我们使用**`**Total Differentials**`**:**

$dx=2udu-2vdv$,$dy=udv+vdu$,$dz=2xdx+2ydy$
我们联立上面三个式子: $dz=2x(2udu-2vdv)+2y(udv+vdu)=(4ux+2vy)du+(2uy-4xv)dv$
所以$\frac{\partial z}{\partial u}=4ux+2vy$和第一种方法一致

# 3 梯度与等高面⭐⭐⭐⭐⭐⭐
## 3.1 梯度
[Gradient.pdf](https://www.yuque.com/attachments/yuque/0/2022/pdf/12393765/1659360389410-9f1b496c-107a-491a-9b25-f40e945d282b.pdf)
### Basics
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044262331.png)
**此处需要特别留意梯度的定义，在二元函数**$f(x,y)$**，梯度向量**$\nabla f$**是一个水平向量, 垂直于任何等高曲线(面)**
如果我们从`Velocity Vector`的视角去理解的话, 会有如下定义。
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044266541.png)
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044263324.png)
:::
### 
### Matrix Notations
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044268697.png)
**我们可以使用矩阵的形式对多元函数的梯度进行改写:**
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044265041.png)
:::


## 3.2 等高面的切平面⭐⭐⭐
### 定义
> 假设$S$是$F(x,y,z)=k$代表的曲面，假设$P(x_0,y_0,z_0)$是这个曲面$S$上的一点。 
> 假设$C$是这个曲面$S$上的任意一条过点$P$的曲线，定义为$r(t)=\langle x(t),y(t),z(t)\rangle$。假设$P$是在$C$上运动的质点，且在$t_0$时刻处于$(x_0,y_0,z_0)$,则$r(t_0)=\langle x_0,y_0,z_0\rangle$
> 因为$C$在曲面$S$上，所以任何曲线$C$上的点$(x(t),y(t),z(t))$,都必须满足$F(x(t),y(t),z(t))=k$
> 我们可以对等式两边使用链式法则得到如下等式:
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044261593.png)
> 结合梯度的定义，我们有:
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044268870.png)
> 研究在$P$处的梯度，我们有:
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044277987.png)
> **于是我们可以得到在**$P$**处的等高面的切平面表达式:**
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044273720.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044271391.png)



### Matrix Notation
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044279811.png)![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044274324.png)
:::
**Example(n-dimensional paraboloid)**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044271479.png)![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044274092.png)![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044276713.png)![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044286284.png)

### 算例
#### 算例1
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044284881.png)

**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044284579.png)

#### 算例2
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044287519.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044283126.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044282710.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044284821.png)



#### 算例3
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044284831.png)



#### 算例4 ⭐⭐
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044294811.png)


#### 算例5: 梯度垂直于等高线⭐⭐
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044292982.png)
:::
**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044294748.png)


#### 算例6: 转化成等高线问题
:::info
我们在求一元函数在某点的切线向量的时候，可以将其转化成一个多元函数的等高线问题
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044291380.png)
:::
**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044294672.png)


## 3.3 证明垂直性
[Proof of perpendicularity.pdf](https://www.yuque.com/attachments/yuque/0/2022/pdf/12393765/1660115390541-d8296742-cf32-4e44-b7f4-5b50c9888e07.pdf)
### 证明流程
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044295603.png)
> 图中展示的是等高面， **证明的是某点的梯度垂直于等高面(线)上的所有切平面（切向量）**


### 课堂用例
:::info
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044303189.png)
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044309530.png)
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044308949.png)
![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044304019.png)
三维情况下，梯度垂直于一个**等高面**
:::


#### 

## 3.4 Normal Line
### 3.4.1 定义
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044305114.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044305304.png)

> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044301744.png)




### 3.4.2 椭球体
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044308230.png)

**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044318683.png)

## 3.5 练习
### P1 计算梯度向量
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044313665.png)

**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044311231.png)
### 
### P2 验证梯度向量垂直性
> 假设$w=x^2+5y^2$
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044316563.png)

**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044315669.png)

### P3 验证二元函数的垂直性⭐⭐
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044311932.png)

**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044315621.png)
这里相当于做了隐函数求导，对于$f(x,y(x))$来说，相当于左右两侧同时对$x$求微分，根据全微分公式可以得到答案。

### P4 计算切平面
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044318032.png)

**Key**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044318494.png)
### 

# 4 方向导数⭐⭐⭐⭐⭐
[Directional Derivatives.pdf](https://www.yuque.com/attachments/yuque/0/2022/pdf/12393765/1660121556546-b547c067-400b-4718-980a-97f02941889e.pdf)
## 4.0 前言
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044323849.png)
> 我们通过求偏导得到的梯度只能描述多元函数在自变量方向的变化速率，所以方向导数存在的意义就是求得多元函数在任意方向的变化速率。


## 4.1 定义⭐⭐⭐⭐⭐
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044327602.png)
> 用向量表示:
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044321912.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044328003.png)
> **注意这里的几何含义**
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044323891.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044321659.png)



## 4.2 梯度与方向向量⭐⭐⭐
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044328856.png)
> **证明:**
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044329829.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044324839.png)



## 4.3 算例
### 4.3.1 代数视角
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044333900.png)


### 4.3.2 几何视角⭐⭐⭐⭐⭐
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044338300.png)


## 4.4 最大方向导数的方向
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044333219.png)
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044339180.png)
> 其实，如果我们从投影的角度来理解这个式子就会非常清晰，因为$\bf u$是一个**方向可变的**单位向量，而$\bf \bigtriangledown w(P_0)$在某一点的梯度向量(梯度方向)是固定的，所以$\bf \bigtriangledown w(P_0)\cdot u$相当于是$P_0$处的梯度方向向量在$\bf u$方向上的投影，那么自然当$\bf \bigtriangledown w(P_0)=ku$的时候($\bf u$和梯度方向一致时)，乘积最大，这时候$\bf \bigtriangledown w$的变化量最大


## 4.5 练习⭐⭐⭐
> ![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044339488.png)

**(1)**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044338439.png)
在点$(1,1,1)$处的梯度是向上增加的，且是增长最快的方向，那么如果我们取$\bf u$为和梯度相反的方向，就可以得到下降最快的速率了。
**(2)**![image.png](./PART_B__链式法则_梯度_和方向导数.assets/20230302_1044334230.png)

